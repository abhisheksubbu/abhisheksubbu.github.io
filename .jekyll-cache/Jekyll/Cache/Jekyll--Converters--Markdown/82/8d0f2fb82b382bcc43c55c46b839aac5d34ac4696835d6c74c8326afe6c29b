I"‡<p>PMD Source Code Analysis CLI is most preferred choice when it comes to doing statis code analysis on Salesforce Apex Code Assets. In fact, it is recommended by Salesforce themselves.</p>

<h2 id="pre-requisites">Pre-Requisites</h2>
<ol>
  <li>Navigate to <a href="https://pmd.github.io/" target="\_blank">PMD Website</a> and follow the installation procedure for your Operating System of choice.</li>
</ol>

<h2 id="steps-to-perform-code-analysis-on-your-salesforce-code-assets">Steps to perform Code Analysis on your Salesforce Code Assets</h2>
<ol>
  <li>Create a folder named ‚ÄúProjects‚Äù in your local machine</li>
  <li>Open the terminal/command prompt from this ‚ÄúProjects‚Äù folder.</li>
  <li>Execute the following command for creating an empty SFDX project locally
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sfdx force:project:create <span class="nt">--projectname</span> MyPersonalDevOrg
</code></pre></div>    </div>
  </li>
  <li>cd into the newly created project folder
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd </span>MyPersonalDevOrg
</code></pre></div>    </div>
  </li>
  <li>Create a folder named ‚Äúmanifest‚Äù
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mkdir manifest
</code></pre></div>    </div>
  </li>
  <li>Type the following command to open the project in VS Code.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> code <span class="nb">.</span>
</code></pre></div>    </div>
  </li>
  <li>Create a file named ‚Äúpackage.xml‚Äù inside the manifest folder.</li>
  <li>Open the ‚Äúpackage.xml‚Äù file and paste the following contents. Essentially, we are saying that we are interested in Apex Classes, Apex Triggers, Visualforce Pages and Custom Objects only. You can add more metadata to ‚Äúpackage,xml‚Äù file as per your needs.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
 <span class="nt">&lt;Package</span> <span class="na">xmlns=</span><span class="s">"http://soap.sforce.com/2006/04/metadata"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>ApexClass<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>ApexTrigger<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>ApexPage<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>CustomObject<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;version&gt;</span>44.0<span class="nt">&lt;/version&gt;</span>
 <span class="nt">&lt;/Package&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>Create a folder named ‚Äúbuildfiles‚Äù using the following command
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">mkdir </span>buildfiles
</code></pre></div>    </div>
  </li>
  <li>Paste the <strong>server.key</strong> inside the buildfiles folder</li>
  <li>Execute the following command in terminal/command prompt. This will retrieve all the metadata from your SF org to the project folder in metadata format. Please do replace the xxx@xxx.com to your salesforce org username.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sfdx force:mdapi:retrieve <span class="nt">-r</span> retrieved <span class="nt">-k</span> manifest/package.xml <span class="nt">-w</span> 10 <span class="nt">-u</span> xxx@xxx.com
</code></pre></div>    </div>
  </li>
  <li>Unzip the retrieved metadata zip file into a folder named ‚Äúretrieved‚Äù. (<strong>Note</strong> that this unzip command may not work in Windows OS. So manually unzip.)
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unzip retrieved/unpackaged.zip <span class="nt">-d</span> retrieved
</code></pre></div>    </div>
  </li>
  <li>Delete the zip file
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm </span>retrieved/unpackaged.zip
</code></pre></div>    </div>
  </li>
  <li>Create a folder named ‚Äúrulesets‚Äù for storing the rulesets
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>rulesets
</code></pre></div>    </div>
  </li>
  <li>Create a folder named ‚ÄúAnalysisResults‚Äù for storing the code analysis results generated from the PMD CLI.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>AnalysisResults
</code></pre></div>    </div>
  </li>
  <li>Download all the PMD ruleset XML for Apex and organize it in a ‚Äúrulesets‚Äù folder that created in Step 12.
    <ul>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/bestpractices.xml" target="\_blank">Best Practices</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/codestyle.xml" target="\_blank">Code Style</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/design.xml" target="\_blank">Design</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/documentation.xml" target="\_blank">Documentation</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/errorprone.xml" target="\_blank">Code Smell</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/multithreading.xml" target="\_blank">Multithreading</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/performance.xml" target="\_blank">Performance</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/security.xml" target="\_blank">Security</a>
15.</li>
    </ul>
  </li>
</ol>
:ET