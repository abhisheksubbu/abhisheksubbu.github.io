<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/assets/style.css" />
    <link rel="stylesheet" href="/assets/vs.css" />
    <link
      rel="shortcut icon"
      href="/favicon.ico"
      type="image/x-icon"
    />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <script src="https://use.fontawesome.com/186ff9b997.js"></script>
    <title>Apex PMD Code Analysis | AbhishekSubbu</title>
    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-51070250-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-51070250-1');
</script>
 <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Apex PMD Code Analysis | AbhishekSubbu</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Apex PMD Code Analysis" />
<meta name="author" content="Abhishek Sivasubramanian" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this blog post, I will explain how to use PMD static code analysis CLI to analyze code assets in Salesforce." />
<meta property="og:description" content="In this blog post, I will explain how to use PMD static code analysis CLI to analyze code assets in Salesforce." />
<link rel="canonical" href="http://localhost:4000/apex-pmd-code-analysis/" />
<meta property="og:url" content="http://localhost:4000/apex-pmd-code-analysis/" />
<meta property="og:site_name" content="AbhishekSubbu" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-10T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Apex PMD Code Analysis" />
<meta name="twitter:site" content="@abhisheksubbu" />
<meta name="twitter:creator" content="@Abhishek Sivasubramanian" />
<meta name="google-site-verification" content="6nqFBgZdK0gATjDa3ZO3lJ11cpSDhxDmJOhqUs15IFs" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/apex-pmd-code-analysis/","dateModified":"2021-02-10T00:00:00+05:30","datePublished":"2021-02-10T00:00:00+05:30","headline":"Apex PMD Code Analysis","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/apex-pmd-code-analysis/"},"author":{"@type":"Person","name":"Abhishek Sivasubramanian"},"description":"In this blog post, I will explain how to use PMD static code analysis CLI to analyze code assets in Salesforce.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <div class="container-fluid container-app">
      <nav class="navbar navbar-expand-lg navbar-light border-bottom">
  <a class="navbar-brand" href="/"
    ><img
      src="/abhisheksubbu_siteicon.png"
      alt=""
      style="width:64px;"
    />AbhishekSubbu</a
  >
  <button
    class="navbar-toggler"
    type="button"
    data-toggle="collapse"
    data-target="#navbarNavAltMarkup"
    aria-controls="navbarNavAltMarkup"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <ul class="navbar-nav ml-auto">
      <li>
        <a class="nav-item nav-link" href="/blog">Blog</a>
      </li>
      <li>
        <a class="nav-item nav-link" href="/learn"
          >Learn & Upskill</a
        >
      </li>
      <li>
        <a class="nav-item nav-link" href="/about">About</a>
      </li>
      <li>
        <a class="nav-item nav-link" href="/contact">Contact</a>
      </li>
    </ul>
  </div>
</nav>

      <div style="margin-top: 20px; margin-bottom: 20px;"><div style="margin-bottom: 2rem;">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      <li class="breadcrumb-item"><a href="/blog/index.html">Blog</a></li>
      <li class="breadcrumb-item active" aria-current="page">
        Apex PMD Code Analysis
      </li>
    </ol>
  </nav>
</div>
<h1>Apex PMD Code Analysis</h1>
<p>
  Posted by <a href="https://twitter.com/abhisheksubbu">Abhishek</a> on
  <span class="date">
    February 10, 2021
  </span>
</p>
<p>
  
  <a
    href="/categories/#salesforce"
    class="badge badge-secondary"
    >Salesforce</a
  >
  
  <a
    href="/categories/#best-practices"
    class="badge badge-secondary"
    >Best Practices</a
  >
  
</p>
<p>PMD Source Code Analysis CLI is most preferred choice when it comes to doing statis code analysis on Salesforce Apex Code Assets. In fact, it is recommended by Salesforce themselves.</p>

<h2 id="pre-requisites">Pre-Requisites</h2>
<ol>
  <li>Navigate to <a href="https://pmd.github.io/" target="\_blank">PMD Website</a> and follow the installation procedure for your Operating System of choice.</li>
</ol>

<h2 id="steps-to-perform-code-analysis-on-your-salesforce-code-assets">Steps to perform Code Analysis on your Salesforce Code Assets</h2>
<ol>
  <li>Create a folder named “Projects” in your local machine</li>
  <li>Open the terminal/command prompt from this “Projects” folder.</li>
  <li>Execute the following command for creating an empty SFDX project locally
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sfdx force:project:create <span class="nt">--projectname</span> MyPersonalDevOrg
</code></pre></div>    </div>
  </li>
  <li>cd into the newly created project folder
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd </span>MyPersonalDevOrg
</code></pre></div>    </div>
  </li>
  <li>Create a folder named “manifest”
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mkdir manifest
</code></pre></div>    </div>
  </li>
  <li>Type the following command to open the project in VS Code.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> code <span class="nb">.</span>
</code></pre></div>    </div>
  </li>
  <li>Create a file named “package.xml” inside the manifest folder.</li>
  <li>Open the “package.xml” file and paste the following contents. Essentially, we are saying that we are interested in Apex Classes, Apex Triggers, Visualforce Pages and Custom Objects only. You can add more metadata to “package,xml” file as per your needs.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
 <span class="nt">&lt;Package</span> <span class="na">xmlns=</span><span class="s">"http://soap.sforce.com/2006/04/metadata"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>ApexClass<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>ApexTrigger<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>ApexPage<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;types&gt;</span>
         <span class="nt">&lt;members&gt;</span>*<span class="nt">&lt;/members&gt;</span>
         <span class="nt">&lt;name&gt;</span>CustomObject<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;/types&gt;</span>
     <span class="nt">&lt;version&gt;</span>44.0<span class="nt">&lt;/version&gt;</span>
 <span class="nt">&lt;/Package&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>Create a folder named “buildfiles” using the following command
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">mkdir </span>buildfiles
</code></pre></div>    </div>
  </li>
  <li>Paste the <strong>server.key</strong> inside the buildfiles folder</li>
  <li>Execute the following command in terminal/command prompt. This will retrieve all the metadata from your SF org to the project folder in metadata format. Please do replace the xxx@xxx.com to your salesforce org username.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sfdx force:mdapi:retrieve <span class="nt">-r</span> retrieved <span class="nt">-k</span> manifest/package.xml <span class="nt">-w</span> 10 <span class="nt">-u</span> xxx@xxx.com
</code></pre></div>    </div>
  </li>
  <li>Unzip the retrieved metadata zip file into a folder named “retrieved”. (<strong>Note</strong> that this unzip command may not work in Windows OS. So manually unzip.)
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unzip retrieved/unpackaged.zip <span class="nt">-d</span> retrieved
</code></pre></div>    </div>
  </li>
  <li>Delete the zip file
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm </span>retrieved/unpackaged.zip
</code></pre></div>    </div>
  </li>
  <li>Create a folder named “rulesets” for storing the rulesets
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>rulesets
</code></pre></div>    </div>
  </li>
  <li>Create a folder named “AnalysisResults” for storing the code analysis results generated from the PMD CLI.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>AnalysisResults
</code></pre></div>    </div>
  </li>
  <li>Download all the PMD ruleset XML for Apex and organize it in a “rulesets” folder that created in Step 12.
    <ul>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/bestpractices.xml" target="\_blank">Best Practices</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/codestyle.xml" target="\_blank">Code Style</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/design.xml" target="\_blank">Design</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/documentation.xml" target="\_blank">Documentation</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/errorprone.xml" target="\_blank">Code Smell</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/multithreading.xml" target="\_blank">Multithreading</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/performance.xml" target="\_blank">Performance</a></li>
      <li><a href="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/docs/security.xml" target="\_blank">Security</a></li>
    </ul>
  </li>
  <li>Open a command prompt on the root folder of your Project.</li>
  <li>Execute following commands to generate the code analysis results in HTML Format.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/bestpractices.xml <span class="nt">-reportfile</span> ./AnalysisResults/bestpractices.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/codestyle.xml <span class="nt">-reportfile</span> ./AnalysisResults/codestyle.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/design.xml <span class="nt">-reportfile</span> ./AnalysisResults/design.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/documentation.xml <span class="nt">-reportfile</span> ./AnalysisResults/documentation.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/errorprone.xml <span class="nt">-reportfile</span> ./AnalysisResults/errorprone.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/multithreading.xml <span class="nt">-reportfile</span> ./AnalysisResults/threading.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/performance.xml <span class="nt">-reportfile</span> ./AnalysisResults/performance.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> summaryhtml <span class="nt">-R</span> ./rulesets/security.xml <span class="nt">-reportfile</span> ./AnalysisResults/security.html
</code></pre></div>    </div>
  </li>
  <li>You can also use the following commands to generate code analysis results in CSV Format. I usually prefer this.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/bestpractices.xml <span class="nt">-reportfile</span> ./AnalysisResults/bestpractices.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/codestyle.xml <span class="nt">-reportfile</span> ./AnalysisResults/codestyle.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/design.xml <span class="nt">-reportfile</span> ./AnalysisResults/design.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/documentation.xml <span class="nt">-reportfile</span> ./AnalysisResults/documentation.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/errorprone.xml <span class="nt">-reportfile</span> ./AnalysisResults/errorprone.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/multithreading.xml <span class="nt">-reportfile</span> ./AnalysisResults/threading.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/performance.xml <span class="nt">-reportfile</span> ./AnalysisResults/performance.html
pmd <span class="nt">-d</span> ./retrieved/unpackaged <span class="nt">-f</span> csv <span class="nt">-R</span> ./rulesets/security.xml <span class="nt">-reportfile</span> ./AnalysisResults/security.html
</code></pre></div>    </div>
  </li>
</ol>

<p>Hurray ! We just analyzed all of our apex code assets in a matter of few minutes.
The next step is to go over each and every finding in the CSV and take corrective action on your code asset. Please do refer my blog on <a href="/recommendations-to-fixing-issues-in-apex-code/">Recommendations to fixing issues in Apex code</a> to see how well we can fix the issues highlightd by PMD report.</p>

<br />
<strong>Thanks for reading this post. Enjoy !!</strong>
<hr />
<span style="color: black;">Share on: </span>
<!-- AddToAny BEGIN -->
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
  <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
  <a class="a2a_button_facebook"></a>
  <a class="a2a_button_twitter"></a>
  <a class="a2a_button_email"></a>
  <a class="a2a_button_linkedin"></a>
  <a class="a2a_button_telegram"></a>
  <a class="a2a_button_whatsapp"></a>
  <a class="a2a_button_reddit"></a>
  <a class="a2a_button_pinterest"></a>
  <a class="a2a_button_tumblr"></a>
  <a class="a2a_button_pocket"></a>
  <a class="a2a_button_skype"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->

<hr />

<div id="disqus_thread"></div>
<script>
  /**
   *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
   *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
  /*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
  (function() {
    // DON'T EDIT BELOW THIS LINE
    var d = document,
      s = d.createElement("script");
    s.src = "https://abhisheksubbu.disqus.com/embed.js";
    s.setAttribute("data-timestamp", +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>


</div>
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
  <div class="row">
    <div class="col-12 col-md">
      <p class="mv0 lh-copy">
        Made with
        <svg
          aria-labelledby="svg-inline--fa-title-DnkMAVvZBF4e"
          data-prefix="fas"
          data-icon="heart"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
          class="svg-inline--fa fa-heart fa-w-16"
        >
          <title id="svg-inline--fa-title-DnkMAVvZBF4e" class="">
            Markdown and Bootstrap
          </title>
          <path
            fill="currentColor"
            d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"
            class=""
          ></path>
        </svg>
        in
        <a
          href="https://www.google.com/maps/place/Kochi, Kerala"
          target="_blank"
          class="link color-inherit hover-white"
          >Kochi</a
        >.
      </p>
      <small class="d-block mb-3 text-muted"
        >Copyright 2020 © AbhishekSubbu
        <p>
          This is a personal blog. Opinions expressed are solely my own and do
          not express the views or opinions of my employer.
        </p></small
      >
    </div>
    <div class="col-6 col-md">
      <h5>Blog</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/archives"
            >Blog Archives</a
          >
        </li>
        <li>
          <a class="text-muted" href="/categories"
            >Categories</a
          >
        </li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Activities</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/speaking"
            >Speaking Engagements</a
          >
        </li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Resources</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/learn"
            >Learn & Upskill</a
          >
        </li>
        <li>
          <a class="text-muted" href="/learn/deepdives"
            >Deep Dives</a
          >
        </li>
        <li>
          <a class="text-muted" href="/downloads"
            >Downloadables</a
          >
        </li>
      </ul>
    </div>
  </div>
</footer>

    </div>
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
