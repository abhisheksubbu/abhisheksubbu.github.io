<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/assets/style.css" />
    <link rel="stylesheet" href="/assets/vs.css" />
    <link
      rel="shortcut icon"
      href="/favicon.ico"
      type="image/x-icon"
    />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <script src="https://use.fontawesome.com/186ff9b997.js"></script>
    <title>Memento Pattern | AbhishekSubbu</title>
  </head>
  <body>
    <div
  class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm"
>
  <h3 class="my-0 mr-md-auto font-weight-normal">
    <a class="p-2 text-dark" href="/">AbhishekSubbu</a>
  </h3>
  <nav class="my-2 my-md-0 mr-md-3">
    <a class="p-2 text-dark" href="/blog">Blog</a>
    <a class="p-2 text-dark" href="/learn">Learn & Upskill</a>
    <a class="p-2 text-dark" href="/about">About</a>
  </nav>
</div>

    <div class="container">
      <div style="margin-bottom:2rem;">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      <li class="breadcrumb-item"><a href="/blog/index.html">Blog</a></li>
      <li class="breadcrumb-item active" aria-current="page">
        Memento Pattern
      </li>
    </ol>
  </nav>
</div>
<h1>Memento Pattern</h1>
<p>
  Posted by <a href="https://twitter.com/abhisheksubbu">Abhishek</a> on
  <span class="date">
    February 12, 2020
  </span>
</p>
<p>
  
  <a href="#" class="badge badge-secondary">Design Patterns</a>
  
</p>
<h2 id="problem-statement">Problem Statement</h2>

<p>You have an editor in which you can save the content many times. You need an Undo feature in the editor with which you can undo the changes and get the previous content.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">editor</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Editor</span><span class="p">();</span>
        <span class="n">editor</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="s">"First Content"</span><span class="p">);</span>
        <span class="n">editor</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="s">"Second Content"</span><span class="p">);</span>
        <span class="n">editor</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="s">"Third Content"</span><span class="p">);</span>
        <span class="n">editor</span><span class="p">.</span><span class="nf">undo</span><span class="p">();</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">editor</span><span class="p">.</span><span class="nf">getContent</span><span class="p">());</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The output should be “Second Content”.</p>

<p>Put some thoughts on how you can achieve this using your programming language. Do not google and try to find out a solution. If you have achieved the solution/not able to figure out the solution, let’s now look at the solution approach.</p>

<h2 id="solution-approach">Solution Approach</h2>

<p><img src="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/images/Memento.png" alt="Memento UML" /></p>

<h2 id="explanation-of-the-uml">Explanation of the UML</h2>

<ul>
  <li>Editor is the class that stores the current version of the content. It can create a new content state when new data is provided as well as restore the state when undo is requested. In this case, Editor is called the Originator because editor is the one that takes the content &amp; initiates the undo.</li>
  <li>To maintain the Single Responsibility Principle, we do not want to keep the previous states in the Editor class. Therefore, we bring an EditorState class that simply stores the state of the editor. EditorState class is useful if the editor needs to maintain the state of content &amp; in future wants to also maintain state of something else in the editor.Because EditorState deals with only the state (which is what we want to do undo on), we call this as the Memento.</li>
  <li>The History class stores the list of EditorState objects and knows how to maintain the states and get the previous states. Thus, we call History class as the Caretaker.</li>
</ul>

<h2 id="implementation">Implementation</h2>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Editor</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">content</span><span class="p">;</span>

    <span class="k">public</span> <span class="n">EditorState</span> <span class="nf">createState</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">EditorState</span><span class="p">(</span><span class="n">content</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">restore</span><span class="p">(</span><span class="n">EditorState</span> <span class="n">state</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">content</span> <span class="p">=</span> <span class="n">state</span><span class="p">.</span><span class="nf">getContent</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">setContent</span><span class="p">(</span><span class="kt">string</span> <span class="n">content</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">content</span> <span class="p">=</span> <span class="n">content</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="nf">getContent</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">content</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">EditorState</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">String</span> <span class="n">content</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">EditorState</span><span class="p">(</span><span class="n">String</span> <span class="n">content</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">content</span> <span class="p">=</span> <span class="n">content</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">String</span> <span class="nf">getContent</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">content</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">History</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">EditorState</span><span class="p">&gt;</span> <span class="n">states</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">EditorState</span><span class="p">&gt;();</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">push</span><span class="p">(</span><span class="n">EditorState</span> <span class="n">state</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">states</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">EditorState</span> <span class="nf">pop</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">lastState</span> <span class="p">=</span> <span class="n">states</span><span class="p">[</span><span class="n">states</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="m">1</span><span class="p">];</span>
        <span class="n">states</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">lastState</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">states</span><span class="p">[</span><span class="n">states</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="m">1</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">editor</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Editor</span><span class="p">();</span>
        <span class="kt">var</span> <span class="n">history</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">History</span><span class="p">();</span>
        <span class="n">editor</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="s">"First Content"</span><span class="p">);</span>
        <span class="n">history</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="n">editor</span><span class="p">.</span><span class="nf">createState</span><span class="p">());</span>

        <span class="n">editor</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="s">"Second Content"</span><span class="p">);</span>
        <span class="n">history</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="n">editor</span><span class="p">.</span><span class="nf">createState</span><span class="p">());</span>

        <span class="n">editor</span><span class="p">.</span><span class="nf">setContent</span><span class="p">(</span><span class="s">"Third Content"</span><span class="p">);</span>
        <span class="n">history</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="n">editor</span><span class="p">.</span><span class="nf">createState</span><span class="p">());</span>

        <span class="n">editor</span><span class="p">.</span><span class="nf">restore</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="nf">pop</span><span class="p">());</span> <span class="c1">//this is the UNDO</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">editor</span><span class="p">.</span><span class="nf">getContent</span><span class="p">());</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

 <footer class="pt-4 my-md-5 pt-md-5 border-top">
  <div class="row">
    <div class="col-12 col-md">
      <p class="mv0 lh-copy">
        Made with
        <svg
          aria-labelledby="svg-inline--fa-title-DnkMAVvZBF4e"
          data-prefix="fas"
          data-icon="heart"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
          class="svg-inline--fa fa-heart fa-w-16"
        >
          <title id="svg-inline--fa-title-DnkMAVvZBF4e" class="">
            Markdown and Bootstrap
          </title>
          <path
            fill="currentColor"
            d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"
            class=""
          ></path>
        </svg>
        in
        <a
          href="https://www.google.com/maps/place/Kochi, Kerala"
          target="_blank"
          class="link color-inherit hover-white"
          >Kochi</a
        >.
      </p>
      <small class="d-block mb-3 text-muted"
        >Copyright 2020 © AbhishekSubbu
        <p>
          This is a personal blog. Opinions expressed are solely my own and do
          not express the views of opinions of my employer.
        </p></small
      >
    </div>
    <div class="col-6 col-md">
      <h5>Blog</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/archives"
            >Blog Archives</a
          >
        </li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Speaking</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/speaking"
            >Speaking/Videos</a
          >
        </li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Resources</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/learn"
            >Learn & Upskill</a
          >
        </li>
        <li>
          <a class="text-muted" href="/downloads"
            >Downloadables</a
          >
        </li>
      </ul>
    </div>
  </div>
</footer>

    </div>
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
