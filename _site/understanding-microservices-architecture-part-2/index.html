<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/assets/style.css" />
    <link rel="stylesheet" href="/assets/vs.css" />
    <link
      rel="shortcut icon"
      href="/favicon.ico"
      type="image/x-icon"
    />
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <script src="https://use.fontawesome.com/186ff9b997.js"></script>
    <title>Understanding Microservices Architecture Part 2 | AbhishekSubbu</title>
    <script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-51070250-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-51070250-1');
</script>
 <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Understanding Microservices Architecture Part 2 | AbhishekSubbu</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Understanding Microservices Architecture Part 2" />
<meta name="author" content="Abhishek Sivasubramanian" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In the previous blog of “Understanding Microservices Architecture – Part 1“, we did a detailed study about monolithic v/s microservices architecture, the benefits and drawbacks of each architecture and the solution approaches to it. I highly recommend you to read the “Understanding Microservices Architecture – Part 1” blog before diving into this blog as it…" />
<meta property="og:description" content="In the previous blog of “Understanding Microservices Architecture – Part 1“, we did a detailed study about monolithic v/s microservices architecture, the benefits and drawbacks of each architecture and the solution approaches to it. I highly recommend you to read the “Understanding Microservices Architecture – Part 1” blog before diving into this blog as it…" />
<link rel="canonical" href="https://abhisheksubbu.github.io//understanding-microservices-architecture-part-2/" />
<meta property="og:url" content="https://abhisheksubbu.github.io//understanding-microservices-architecture-part-2/" />
<meta property="og:site_name" content="AbhishekSubbu" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-11T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Understanding Microservices Architecture Part 2" />
<meta name="twitter:site" content="@abhisheksubbu" />
<meta name="twitter:creator" content="@Abhishek Sivasubramanian" />
<meta name="google-site-verification" content="6nqFBgZdK0gATjDa3ZO3lJ11cpSDhxDmJOhqUs15IFs" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Abhishek Sivasubramanian"},"dateModified":"2019-12-11T00:00:00-05:00","datePublished":"2019-12-11T00:00:00-05:00","description":"In the previous blog of “Understanding Microservices Architecture – Part 1“, we did a detailed study about monolithic v/s microservices architecture, the benefits and drawbacks of each architecture and the solution approaches to it. I highly recommend you to read the “Understanding Microservices Architecture – Part 1” blog before diving into this blog as it…","headline":"Understanding Microservices Architecture Part 2","mainEntityOfPage":{"@type":"WebPage","@id":"https://abhisheksubbu.github.io//understanding-microservices-architecture-part-2/"},"url":"https://abhisheksubbu.github.io//understanding-microservices-architecture-part-2/"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <div class="container-fluid container-app">
      <nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarTogglerDemo01"
      aria-controls="navbarTogglerDemo01"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
      <a
        class="navbar-brand d-flex align-items-center"
        href="/"
      >
        <img
          src="/abhisheksubbu_siteicon.png"
          alt="Logo"
          width="64px"
          class="d-inline-block align-text-top"
        />
        AbhishekSubbu
      </a>
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" href="/blog">Blog</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/contact">Contact</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

      <div style="margin-top: 20px; margin-bottom: 20px"><div style="margin-bottom: 2rem">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      <li class="breadcrumb-item"><a href="/blog/index.html">Blog</a></li>
      <li class="breadcrumb-item active" aria-current="page">
        Understanding Microservices Architecture Part 2
      </li>
    </ol>
  </nav>
</div>
<h1>Understanding Microservices Architecture Part 2</h1>
<p>
  Posted by <a href="https://twitter.com/abhisheksubbu">Abhishek</a> on
  <span class="date"> December 11, 2019 </span>
</p>
<p>
  
  <a
    href="/categories/#architecture"
    class="badge text-bg-secondary"
    >Architecture</a
  >
  
</p>
<p>In the previous blog of “<a href="/understanding-microservices-architecture/">Understanding Microservices Architecture – Part 1</a>“, we did a detailed study about monolithic v/s microservices architecture, the benefits and drawbacks of each architecture and the solution approaches to it. I highly recommend you to read the “<a href="/understanding-microservices-architecture/">Understanding Microservices Architecture – Part 1</a>” blog before diving into this blog as it would help you connect to the context of what we are going to learn here. Well, we understood that Microservices Architecture is the way forward. Now, here comes a lots of questions in our mind.</p>

<ul>
  <li>How to design &amp; deploy these services?</li>
  <li>How should the services communicate?</li>
  <li>How do the client applications communicate with all these services?</li>
  <li>How do we correctly partition the monolithic application into services?</li>
  <li>How do we deal with distributed data management problems?</li>
</ul>

<p>The solution here is to <strong>adopt EVENT BASED approach</strong> into microservices to solve the interaction issues. With respect to data management, we can either choose “<strong>Shared Database</strong>” approach or “<strong>Database per service</strong>” approach. With “Shared Database” approach, you have 1 single database with many tables in it. Different services might talk to one of more tables. This is pretty simple to achieve and ACID principles help maintain data consistency. But the biggest problem with this approach is that individual services have tight coupling with the database. This means that if we design a set of microservices, then every microservices would have to talk to this single database. If a team working on order service decides to update the database schema, then they have to go and talk to other service team and figure out if this schema update will break their service or not. Thus, things slow down and team start losing their autonomy/independent nature. As autonomy degrades, sticking to agile model becomes painful. The recommended approach in Microservices is for each service to have its own database. Therefore, each service gets it own private database which has all the information for that service to operate. For example, Order Service has an Order Database, Customer Service has a Customer Database and so on. This ensures <strong>Loose Coupling</strong>. But it’s more complex to get this working from a TRANSACTIONAL scope. Right? Now, we get confused on how a TRANSACTION is defined in Microservices Architecture because different services with their own database have to communicate and co-ordinate for completing a business transaction. The solution to this TRANSACTIONAL confusion is to <strong>adopt EVENT DRIVEN ARCHITECTURE</strong>. This means that when something significant happens in a service, that service has to raise an event. This event can be observed by other services and act upon that. With this, you can achieve eventual consistency in a transaction. For example, when a customer places an order, the following actions takes place.</p>

<ol>
  <li>Order Service creates an Order in PENDING state and emits an event “Order Created”</li>
  <li>The Customer Service listens to the “Order Created” event and performs the credit check. If the credit check is successful, the customer service emits a “Credit Reserved” event. If the credit check failed, then it emits a “Credit Check Failed” event.</li>
  <li>The Order Service listens to “Credit Reserved” and “Credit Check Failed” events and accordingly updates the state of the Order to COMPLETE or FAILED.</li>
</ol>

<p>Here, we have 3 ACID transactions happening on each service and finally contributes to ACID of the entire order transaction becoming consistent. When we say “EMIT AN EVENT”, the question arises</p>

<ul>
  <li>where is the event created?</li>
  <li>is the event persisted as a record?</li>
  <li>What if the order state got updated and event failed to fire?</li>
</ul>

<p>The way to tackle this problem is by using “<strong>EVENT SOURCING</strong>” technique. In this technique, a separate table for Event is maintained where the Id, type of event, event data are all stored. Publisher services write event records to this table. Subscriber services read the event records from this table based on Event Type and carry out their actions. A benefit of Event Sourcing is that the entire history of a transaction from start till end can be traced from this Event Table.
<img src="https://abhisheksubbusite.s3-ap-southeast-1.amazonaws.com/images/event-sourcing.png" alt="Event Sourcing" /></p>

<p>If there is a need to replay/retry from a particular step, you can do that easily because every step/event of the entire transaction was recorded with its data. Benefits of Event Sourcing</p>

<ul>
  <li>It solves the data consistency issues in a Microservice/NoSQL based architecture.</li>
  <li>It provides reliable event publishing mechanism. You can mine this event data and even predict what events can occur in future and raise user notifications/alerts.</li>
  <li>It eliminates the Object Relational Mapping problem because the event is recorded with its own data.</li>
  <li>Because each state change is represented by an event, it helps us build a reliable audit log and create temporal queries to understand what the record state was back in time.</li>
</ul>

<h2 id="drawbacks-of-event-sourcing">Drawbacks of Event Sourcing</h2>

<ul>
  <li>It requires an application rewrite to fit that into microservices architecture.</li>
  <li>It makes breaking down of business logic into weird pieces and thus there is a learning curve to adapt to this unfamiliar style of programming.</li>
  <li>Once an event is published, these event records stay there forever (for historical needs). Sometimes some events might have been because of your bad design decisions.</li>
  <li>We have to handle duplicate events by detecting duplication.</li>
  <li>As the event store grows, querying the event table can be challenging.</li>
</ul>

<p>That was a lot of learning. Isn’t it? In the Part 3, we will understand the querying complexities involved in Microservices and how we can solve this problem.</p>

<br />
<strong>Thanks for reading this post. Enjoy !!</strong>
<hr />
<span style="color: black;">Share on: </span>
<!-- AddToAny BEGIN -->
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
  <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
  <a class="a2a_button_facebook"></a>
  <a class="a2a_button_twitter"></a>
  <a class="a2a_button_email"></a>
  <a class="a2a_button_linkedin"></a>
  <a class="a2a_button_telegram"></a>
  <a class="a2a_button_whatsapp"></a>
  <a class="a2a_button_reddit"></a>
  <a class="a2a_button_pinterest"></a>
  <a class="a2a_button_tumblr"></a>
  <a class="a2a_button_pocket"></a>
  <a class="a2a_button_skype"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->

<hr />

<div id="disqus_thread"></div>
<script>
  /**
   *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
   *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
  /*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
  (function() {
    // DON'T EDIT BELOW THIS LINE
    var d = document,
      s = d.createElement("script");
    s.src = "https://abhisheksubbu.disqus.com/embed.js";
    s.setAttribute("data-timestamp", +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>


</div>
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
  <div class="row">
    <div class="col-12 col-md">
      <p class="mv0 lh-copy">
        Made with
        <svg
          aria-labelledby="svg-inline--fa-title-DnkMAVvZBF4e"
          data-prefix="fas"
          data-icon="heart"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
          class="svg-inline--fa fa-heart fa-w-16"
        >
          <title id="svg-inline--fa-title-DnkMAVvZBF4e" class="">
            Markdown and Bootstrap
          </title>
          <path
            fill="currentColor"
            d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"
            class=""
          ></path>
        </svg>
        in
        <a
          href="https://www.google.com/maps/place/Kochi, Kerala"
          target="_blank"
          class="link color-inherit hover-white"
          >Kochi</a
        >.
      </p>
      <small class="d-block mb-3 text-muted"
        >Copyright 2020 © AbhishekSubbu
        <p>
          This is a personal blog. Opinions expressed are solely my own and do
          not express the views or opinions of my employer.
        </p></small
      >
    </div>
    <div class="col-6 col-md">
      <h5>Blog</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/archives"
            >Blog Archives</a
          >
        </li>
        <li>
          <a class="text-muted" href="/categories"
            >Categories</a
          >
        </li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Activities</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/speaking"
            >Speaking Engagements</a
          >
        </li>
      </ul>
    </div>
    <div class="col-6 col-md">
      <h5>Resources</h5>
      <ul class="list-unstyled text-small">
        <li>
          <a class="text-muted" href="/downloads"
            >Downloadables</a
          >
        </li>
      </ul>
    </div>
  </div>
</footer>

    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
      integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"
      integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
